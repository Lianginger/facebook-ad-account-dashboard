{"version":3,"sources":["pages/utils.js","pages/Home.js","pages/AdAccount.js","pages/App.js","index.js"],"names":["format","data","toDollar","toString","replace","toNumber","toProjectTime","split","date","time","substring","toDate","newDate","Date","year","getFullYear","month","getMonth","slice","getDate","toTime","hours","getHours","minutes","getMinutes","Home","useState","adAccounts","setAdAccounts","user","setUser","useEffect","window","checkLoginState","FB","getLoginStatus","res","console","log","status","state","isLogin","api","name","pictureURL","picture","url","sortedAdAccountsData","adaccounts","sort","a","b","age","map","adAccount","adAccountLive","campaigns","find","adCampaign","fbAsyncInit","init","appId","cookie","xfbml","version","AppEvents","logPageView","d","s","id","js","fjs","getElementsByTagName","getElementById","createElement","src","parentNode","insertBefore","document","className","onClick","logout","response","alt","style","width","data-size","data-button-type","data-layout","data-auto-logout-link","data-use-continue-as","data-width","data-onlogin","data-scope","display","length","amount_spent","key","class","navigate","AdAccount","adAccountId","loading","setLoading","useImmer","platformId","projectId","dateArray","leadSpendArray","leadArray","preLaunchSpendArray","fundRaisingSpendArray","adsDirectRoasArray","totalRoasArray","setAdAccount","dailyFundingDiff","undefined","project","setProject","setPaging","lineChartData","labels","reverse","datasets","label","fill","borderColor","pointBackgroundColor","pointHoverBackgroundColor","yAxisID","fetch","then","json","business_street","business_street2","cursorKey","cursorValue","formatDataMart","paging","fetchAdAccountInsights","Object","keys","values","dateData","adCampaignArray","totalSpend","parseInt","spend","adCampaignSpend","push","totalLead","actions","adCampaignLeadAction","action","action_type","value","toFixed","totalRevenue","action_values","adCampaignOmniPurchaseAction","generateChartData","timeline","JSON","parse","sponsor_count","funding_target","funding_current","started_at","finished_at","fetchFundingData","projectStartAt","getTime","projectFinishAt","timelineDataMart","fundingData","fundingOfThePreviousDay","entries","fundingToday","index","role","margin","maxWidth","paddingTop","backgroundImage","og_image","backgroundSize","backgroundPosition","height","options","maintainAspectRatio","hover","intersect","tooltips","mode","scales","yAxes","type","position","gridLines","drawOnChartArea","scaleLabel","labelString","scope","rawData","dataMart","date_start","campaignType","campaign_name","includes","getCampaignType","App","basepath","primary","path","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.fd420b4b.chunk.js","sourcesContent":["export function format(data) {\r\n  return {\r\n    toDollar() {\r\n      return !data\r\n        ? ''\r\n        : `NTD ${data.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')}`\r\n    },\r\n    toNumber() {\r\n      return !data ? '' : data.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\r\n    },\r\n    toProjectTime() {\r\n      const [date, time] = data.split('T')\r\n      return !data ? '' : `${date} ${time.substring(0, 5)}`\r\n    },\r\n    toDate() {\r\n      // input unix time\r\n      const newDate = new Date(data)\r\n      const year = newDate.getFullYear()\r\n      const month = ('0' + (newDate.getMonth() + 1)).slice(-2)\r\n      const date = ('0' + newDate.getDate()).slice(-2)\r\n      return !data ? '' : `${year}-${month}-${date}`\r\n    },\r\n    toTime() {\r\n      // input unix time\r\n      const newDate = new Date(data)\r\n      const hours = ('0' + newDate.getHours()).slice(-2)\r\n      const minutes = ('0' + newDate.getMinutes()).slice(-2)\r\n      return !data ? '' : `${hours}:${minutes}`\r\n    },\r\n  }\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\nimport { navigate } from '@reach/router'\r\nimport { format } from './utils'\r\n\r\nimport './Home.css'\r\n\r\nfunction Home() {\r\n  const [adAccounts, setAdAccounts] = useState([])\r\n  const [user, setUser] = useState({})\r\n\r\n  useEffect(() => {\r\n    window.checkLoginState = function () {\r\n      window.FB\r\n        ? window.FB.getLoginStatus((res) => {\r\n            console.log(res)\r\n\r\n            if (res.status === 'connected') {\r\n              // Logged into your webpage and Facebook.\r\n              setUser((state) => ({\r\n                ...state,\r\n                isLogin: true,\r\n              }))\r\n\r\n              console.log('fetchUserAndAdAccounts')\r\n              fetchUserAndAdAccounts()\r\n            } else {\r\n              // Not logged into your webpage or we are unable to tell.\r\n              console.log('Please log into this webpage.')\r\n            }\r\n          })\r\n        : console.log('FB not loaded.')\r\n    }\r\n    window.checkLoginState()\r\n\r\n    window.fbAsyncInit = function () {\r\n      window.FB.init({\r\n        appId: '2772453809519165',\r\n        cookie: true,\r\n        xfbml: true,\r\n        version: 'v6.0',\r\n      })\r\n\r\n      window.FB.AppEvents.logPageView()\r\n      window.checkLoginState()\r\n    }\r\n    ;(function (d, s, id) {\r\n      var js,\r\n        fjs = d.getElementsByTagName(s)[0]\r\n      if (d.getElementById(id)) {\r\n        return\r\n      }\r\n      js = d.createElement(s)\r\n      js.id = id\r\n      js.src =\r\n        'https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v7.0&appId=2772453809519165&autoLogAppEvents=1'\r\n      fjs.parentNode.insertBefore(js, fjs)\r\n    })(document, 'script', 'facebook-jssdk')\r\n  }, [])\r\n\r\n  return (\r\n    <div className='container my-3'>\r\n      {/* Avatar、登出 */}\r\n      {user.pictureURL ? (\r\n        <div className='text-right my-3'>\r\n          <div\r\n            className='btn btn-primary'\r\n            onClick={() =>\r\n              window.FB.logout(function (response) {\r\n                setUser({})\r\n                setAdAccounts([])\r\n              })\r\n            }\r\n          >\r\n            <div className=' d-flex align-items-center'>\r\n              <img\r\n                src={user.pictureURL}\r\n                alt='avatar'\r\n                className='rounded-circle'\r\n                style={{ width: '30px' }}\r\n              />\r\n              <span className='mx-2'>登出</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        ''\r\n      )}\r\n      <h1 className='text-center my-3'>廣告帳號</h1>\r\n      {/* 臉書登入 */}\r\n      <div className='w-100 text-center my-3'>\r\n        <div\r\n          className='fb-login-button'\r\n          data-size='large'\r\n          data-button-type='continue_with'\r\n          data-layout='default'\r\n          data-auto-logout-link='false'\r\n          data-use-continue-as='true'\r\n          data-width=''\r\n          data-onlogin='checkLoginState();'\r\n          data-scope='public_profile,email,ads_read,business_management'\r\n          style={{ display: user.isLogin ? 'none' : 'block' }}\r\n        ></div>\r\n      </div>\r\n\r\n      {/* 廣告帳戶列表 */}\r\n\r\n      {adAccounts.length > 0 ? (\r\n        <main className='d-flex flex-wrap justify-content-center'>\r\n          {adAccounts.map(({ name, id, adAccountLive, amount_spent }) => (\r\n            <div\r\n              key={id}\r\n              class='card m-1 ad-account-card'\r\n              style={{ width: '18rem' }}\r\n            >\r\n              <div\r\n                class='card-body'\r\n                onClick={() =>\r\n                  navigate(`/facebook-ad-account-dashboard/ad-account/${id}`)\r\n                }\r\n              >\r\n                <h5 class='card-title'>{name}</h5>\r\n                {adAccountLive ? (\r\n                  <p className='text-success'>ACTIVE</p>\r\n                ) : (\r\n                  <p className='text-secondary'>PAUSED</p>\r\n                )}\r\n                <p class='card-text'>\r\n                  總廣告花費：{format(amount_spent).toDollar()}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </main>\r\n      ) : (\r\n        ''\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  function fetchUserAndAdAccounts() {\r\n    window.FB.api(\r\n      '/me?fields=name,picture{url},adaccounts.limit(1000){age,name,amount_spent,campaigns.limit(1000){status,name}}',\r\n      function (res) {\r\n        setUser((state) => ({\r\n          ...state,\r\n          name: res.name,\r\n          pictureURL: res.picture.data.url,\r\n        }))\r\n\r\n        let sortedAdAccountsData = res.adaccounts.data.sort(\r\n          (a, b) => a.age - b.age\r\n        )\r\n        // 遍歷廣告活動狀態，在廣告帳戶物件加上 adAccountLive flag\r\n        sortedAdAccountsData = sortedAdAccountsData.map((adAccount) => {\r\n          adAccount.adAccountLive = false\r\n          if (adAccount.campaigns) {\r\n            const activeAdCampaign = adAccount.campaigns.data.find(\r\n              (adCampaign) => {\r\n                return adCampaign.status === 'ACTIVE'\r\n              }\r\n            )\r\n\r\n            if (activeAdCampaign) {\r\n              adAccount.adAccountLive = true\r\n            }\r\n          }\r\n\r\n          return adAccount\r\n        })\r\n        setAdAccounts((state) => [...sortedAdAccountsData])\r\n      }\r\n    )\r\n  }\r\n}\r\n\r\nexport default Home\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useImmer } from 'use-immer'\r\nimport { Line } from 'react-chartjs-2'\r\nimport { navigate } from '@reach/router'\r\nimport { format } from './utils'\r\n\r\nimport './AdAccount.css'\r\n\r\nfunction AdAccount({ adAccountId }) {\r\n  const [loading, setLoading] = useState(true)\r\n  const [adAccount, setAdAccount] = useImmer({\r\n    name: '',\r\n    platformId: '',\r\n    projectId: '',\r\n    data: [],\r\n    dateArray: [],\r\n    leadSpendArray: [],\r\n    leadArray: [],\r\n    preLaunchSpendArray: [],\r\n    fundRaisingSpendArray: [],\r\n    adsDirectRoasArray: [],\r\n    totalRoasArray: [],\r\n  })\r\n  const [project, setProject] = useImmer({\r\n    dailyFundingDiff: undefined,\r\n  })\r\n  const [paging, setPaging] = useState({})\r\n\r\n  const chartConfigOptions = {\r\n    maintainAspectRatio: false,\r\n    hover: {\r\n      intersect: false,\r\n    },\r\n    tooltips: {\r\n      mode: 'index',\r\n      intersect: false,\r\n    },\r\n    scales: {\r\n      yAxes: [\r\n        {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'left',\r\n          id: 'y-axis-1',\r\n          gridLines: {\r\n            drawOnChartArea: false,\r\n          },\r\n          scaleLabel: {\r\n            display: true,\r\n            labelString: '名單取得成本',\r\n          },\r\n        },\r\n        {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'right',\r\n          id: 'y-axis-2',\r\n          scaleLabel: {\r\n            display: true,\r\n            labelString: 'ROAS',\r\n          },\r\n        },\r\n      ],\r\n    },\r\n  }\r\n\r\n  const lineChartData = {\r\n    labels: [...adAccount.dateArray].reverse(),\r\n    datasets: [\r\n      {\r\n        label: 'CPL',\r\n        fill: false,\r\n        borderColor: '#1f4068',\r\n        pointBackgroundColor: '#1f4068',\r\n        pointHoverBackgroundColor: '#1f4068',\r\n        data: [...adAccount.leadArray].reverse(),\r\n        yAxisID: 'y-axis-1',\r\n      },\r\n      // {\r\n      //   label: '廣告直接 ROAS',\r\n      //   fill: false,\r\n      //   borderColor: '#1b1b2f',\r\n      //   pointBackgroundColor: '#1b1b2f',\r\n      //   pointHoverBackgroundColor: '#1b1b2f',\r\n      //   data: [...adAccount.adsDirectRoasArray].reverse(),\r\n      //   yAxisID: 'y-axis-2',\r\n      // },\r\n      {\r\n        label: '總體 ROAS',\r\n        fill: false,\r\n        borderColor: '#e43f5a',\r\n        pointBackgroundColor: '#e43f5a',\r\n        pointHoverBackgroundColor: '#e43f5a',\r\n        data: [...adAccount.totalRoasArray].reverse(),\r\n        yAxisID: 'y-axis-2',\r\n      },\r\n    ],\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchAdAccountInfo()\r\n    fetchAdAccountInsights()\r\n\r\n    function fetchAdAccountInfo() {\r\n      fetch(\r\n        // `http://localhost:8000/ad-account/info/${adAccountId}`\r\n        `https://fb-ads-api.herokuapp.com/ad-account/info/${adAccountId}`\r\n      )\r\n        .then((res) => res.json())\r\n        .then((res) => {\r\n          setAdAccount((state) => {\r\n            state.name = res.name\r\n            state.platformId = res.business_street\r\n            state.projectId = res.business_street2\r\n          })\r\n        })\r\n    }\r\n  }, [adAccountId])\r\n\r\n  useEffect(() => {\r\n    generateChartData()\r\n\r\n    function generateChartData() {\r\n      let dateArray = Object.keys(adAccount.data)\r\n      let leadSpendArray = []\r\n      let leadArray = []\r\n      let preLaunchSpendArray = []\r\n      let fundRaisingSpendArray = []\r\n      let adsDirectRoasArray = []\r\n\r\n      Object.values(adAccount.data).map((dateData) => {\r\n        if (dateData['預熱']) {\r\n          const adCampaignArray = dateData['預熱']\r\n          let totalSpend = 0\r\n\r\n          adCampaignArray.map((adCampaign) => {\r\n            if (parseInt(adCampaign.spend) === 0) {\r\n              return\r\n            }\r\n\r\n            const adCampaignSpend = parseInt(adCampaign.spend)\r\n\r\n            totalSpend += adCampaignSpend\r\n          })\r\n          if (totalSpend !== 0) {\r\n            preLaunchSpendArray.push(totalSpend)\r\n          } else {\r\n            preLaunchSpendArray.push(null)\r\n          }\r\n        } else {\r\n          preLaunchSpendArray.push(null)\r\n        }\r\n\r\n        if (dateData['前測']) {\r\n          const adCampaignArray = dateData['前測']\r\n          let totalSpend = 0\r\n          let totalLead = 0\r\n\r\n          adCampaignArray.map((adCampaign) => {\r\n            if (parseInt(adCampaign.spend) === 0 || !adCampaign.actions) {\r\n              return\r\n            }\r\n\r\n            const adCampaignSpend = parseInt(adCampaign.spend)\r\n            const adCampaignLeadAction = adCampaign.actions.find(\r\n              (action) =>\r\n                action.action_type === 'offsite_conversion.fb_pixel_custom'\r\n            )\r\n\r\n            totalSpend += adCampaignSpend\r\n            totalLead += adCampaignLeadAction\r\n              ? parseInt(adCampaignLeadAction.value)\r\n              : 0\r\n          })\r\n          if (totalSpend !== 0 && totalLead !== 0) {\r\n            leadSpendArray.push(totalSpend)\r\n            leadArray.push((totalSpend / totalLead).toFixed(1))\r\n          } else {\r\n            leadSpendArray.push(null)\r\n            leadArray.push(null)\r\n          }\r\n        } else {\r\n          leadSpendArray.push(null)\r\n          leadArray.push(null)\r\n        }\r\n\r\n        if (dateData['嘖嘖']) {\r\n          const adCampaignArray = dateData['嘖嘖']\r\n          let totalSpend = 0\r\n          let totalRevenue = 0\r\n\r\n          adCampaignArray.map((adCampaign) => {\r\n            if (parseInt(adCampaign.spend) === 0 || !adCampaign.action_values) {\r\n              return\r\n            }\r\n\r\n            const adCampaignSpend = parseInt(adCampaign.spend)\r\n            const adCampaignOmniPurchaseAction = adCampaign.action_values.find(\r\n              (action) => action.action_type === 'omni_purchase'\r\n            )\r\n            totalSpend += adCampaignSpend\r\n            totalRevenue += adCampaignOmniPurchaseAction\r\n              ? parseInt(adCampaignOmniPurchaseAction.value)\r\n              : 0\r\n          })\r\n\r\n          if (totalSpend !== 0 && totalRevenue !== 0) {\r\n            fundRaisingSpendArray.push(totalSpend)\r\n            adsDirectRoasArray.push((totalRevenue / totalSpend).toFixed(1))\r\n          } else {\r\n            fundRaisingSpendArray.push(null)\r\n            adsDirectRoasArray.push(null)\r\n          }\r\n        } else {\r\n          fundRaisingSpendArray.push(null)\r\n          adsDirectRoasArray.push(null)\r\n        }\r\n      })\r\n\r\n      setAdAccount((state) => {\r\n        state.dateArray = dateArray\r\n        state.leadSpendArray = leadSpendArray\r\n        state.leadArray = leadArray\r\n        state.preLaunchSpendArray = preLaunchSpendArray\r\n        state.fundRaisingSpendArray = fundRaisingSpendArray\r\n        state.adsDirectRoasArray = adsDirectRoasArray\r\n      })\r\n    }\r\n  }, [adAccount.data])\r\n\r\n  useEffect(() => {\r\n    const platformId = adAccount.platformId\r\n    const projectId = adAccount.projectId\r\n    if (platformId && projectId) {\r\n      fetchFundingData(platformId, projectId)\r\n    }\r\n\r\n    function fetchFundingData(platformId, projectId) {\r\n      fetch(\r\n        `https://drip.zectrack.today/api/platform/${platformId}/projects/${projectId}`\r\n      )\r\n        .then((res) => res.json())\r\n        .then((res) => {\r\n          setProject((state) => ({\r\n            ...state,\r\n            ...res,\r\n            timeline: JSON.parse(res.timeline).sort((a, b) => a[0] - b[0]),\r\n            sponsor_count: format(res.sponsor_count).toNumber(),\r\n            funding_target: format(res.funding_target).toDollar(),\r\n            funding_current: format(res.funding_current).toDollar(),\r\n            started_at: format(res.started_at).toProjectTime(),\r\n            finished_at: format(res.finished_at).toProjectTime(),\r\n          }))\r\n        })\r\n    }\r\n  }, [adAccount.platformId, adAccount.projectId])\r\n\r\n  useEffect(() => {\r\n    if (!project.timeline) return\r\n\r\n    // Add datetime.slice(0,-1) to cut the denoted by the suffix \"Z\"\r\n    let projectStartAt =\r\n      new Date(project.started_at.slice(0, -1)).getTime() / 1000\r\n    let projectFinishAt =\r\n      new Date(project.finished_at.slice(0, -1)).getTime() / 1000\r\n    // Minus one hour to get the zero data.\r\n    projectStartAt = projectStartAt - 60 * 60\r\n\r\n    const timelineDataMart = {}\r\n    project.timeline.map((data) => {\r\n      if (data[0] < projectStartAt || data[0] > projectFinishAt) return\r\n\r\n      const date = format(data[0] * 1000).toDate()\r\n      const time = format(data[0] * 1000).toTime()\r\n      const fundingData = [time, data[1], data[2]]\r\n\r\n      timelineDataMart[date]\r\n        ? timelineDataMart[date].push(fundingData)\r\n        : (timelineDataMart[date] = [fundingData])\r\n    })\r\n\r\n    const dailyFundingDiff = {}\r\n    let fundingOfThePreviousDay = 0\r\n    for (let [date, fundingData] of Object.entries(timelineDataMart)) {\r\n      const fundingToday = fundingData[fundingData.length - 1][2]\r\n      dailyFundingDiff[date] = fundingToday - fundingOfThePreviousDay\r\n      fundingOfThePreviousDay = fundingToday\r\n    }\r\n\r\n    setProject((state) => {\r\n      state.dailyFundingDiff = dailyFundingDiff\r\n    })\r\n  }, [project.timeline])\r\n\r\n  useEffect(() => {\r\n    if (\r\n      project.dailyFundingDiff &&\r\n      adAccount.fundRaisingSpendArray.length > 0\r\n    ) {\r\n      const totalRoasArray = []\r\n      adAccount.dateArray.map((date, index) => {\r\n        if (\r\n          project.dailyFundingDiff[date] &&\r\n          adAccount.fundRaisingSpendArray[index]\r\n        ) {\r\n          totalRoasArray.push(\r\n            (\r\n              project.dailyFundingDiff[date] /\r\n              adAccount.fundRaisingSpendArray[index]\r\n            ).toFixed(1)\r\n          )\r\n        } else {\r\n          totalRoasArray.push(null)\r\n        }\r\n      })\r\n      setAdAccount((state) => {\r\n        state.totalRoasArray = totalRoasArray\r\n      })\r\n    }\r\n  }, [project.dailyFundingDiff, adAccount.fundRaisingSpendArray])\r\n\r\n  return (\r\n    <div className='container my-3'>\r\n      {loading ? (\r\n        <div className='text-center my-5'>\r\n          <div className='spinner-border text-primary' role='status'>\r\n            <span className='sr-only'>Loading...</span>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          <div\r\n            className='btn btn-primary'\r\n            onClick={() => navigate('/facebook-ad-account-dashboard/')}\r\n          >\r\n            Home\r\n          </div>\r\n          <h1 className='text-center my-3'>{adAccount.name}</h1>\r\n\r\n          {/* 集資資料 */}\r\n          {project.name ? (\r\n            <div className='row'>\r\n              <div className='col-12 col-md-6'>\r\n                <div\r\n                  style={{\r\n                    margin: '0 auto',\r\n                    maxWidth: '480px',\r\n                  }}\r\n                >\r\n                  <div\r\n                    style={{\r\n                      paddingTop: '56.25%',\r\n                      backgroundImage: `url(${project.og_image})`,\r\n                      backgroundSize: 'cover',\r\n                      backgroundPosition: 'center',\r\n                    }}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n              <div className='col-12 col-md-6 p-3'>\r\n                <p>{project.name}</p>\r\n                <h3>{project.funding_current}</h3>\r\n                <hr />\r\n                <p>\r\n                  <span className='font-weight-bolder mr-3'>目標</span>\r\n                  <span className='text-secondary'>\r\n                    {project.funding_target}\r\n                  </span>\r\n                </p>\r\n                <p>\r\n                  <span className='font-weight-bolder mr-3'>贊助人數</span>\r\n                  <span className='text-secondary'>\r\n                    {project.sponsor_count}\r\n                  </span>\r\n                </p>\r\n                <p>\r\n                  <span className='font-weight-bolder mr-3'>時程</span>\r\n                  <span className='text-secondary'>\r\n                    {project.started_at} ~ {project.finished_at}\r\n                  </span>\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            ''\r\n          )}\r\n\r\n          {/* 圖表 */}\r\n          <div className='my-5' style={{ height: '300px' }}>\r\n            <Line data={lineChartData} options={chartConfigOptions} />\r\n          </div>\r\n\r\n          {/* 走速表 */}\r\n          <table className='table'>\r\n            <thead>\r\n              <tr>\r\n                <th scope='col'>Date</th>\r\n                <th scope='col'>前測花費</th>\r\n                <th scope='col'>CPL</th>\r\n                <th scope='col'>預熱花費</th>\r\n                <th scope='col'>上線花費</th>\r\n                <th scope='col'>廣告直接 ROAS</th>\r\n                <th scope='col'>總體 ROAS</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {adAccount.dateArray.map((date, index) => {\r\n                return (\r\n                  <tr key={`daily-adAccount-data-${index}`}>\r\n                    <th>{date}</th>\r\n                    <td>\r\n                      {format(adAccount.leadSpendArray[index]).toDollar()}\r\n                    </td>\r\n                    <td>{format(adAccount.leadArray[index]).toDollar()}</td>\r\n                    <td>\r\n                      {format(adAccount.preLaunchSpendArray[index]).toDollar()}\r\n                    </td>\r\n                    <td>\r\n                      {format(\r\n                        adAccount.fundRaisingSpendArray[index]\r\n                      ).toDollar()}\r\n                    </td>\r\n                    <td>{adAccount.adsDirectRoasArray[index]}</td>\r\n                    <td>{adAccount.totalRoasArray[index]}</td>\r\n                  </tr>\r\n                )\r\n              })}\r\n            </tbody>\r\n          </table>\r\n          {/* Paging */}\r\n          {/* <div className='row'>\r\n            <div className='col-6 text-left'>\r\n              {paging.hasPrevious ? (\r\n                <div\r\n                  className='btn btn-primary'\r\n                  onClick={() => fetchData('before', paging.cursors.before)}\r\n                >\r\n                  Previous\r\n                </div>\r\n              ) : (\r\n                ''\r\n              )}\r\n            </div>\r\n            <div className='col-6 text-right'>\r\n              {paging.hasNext ? (\r\n                <div\r\n                  className='btn btn-primary'\r\n                  onClick={() => fetchData('after', paging.cursors.after)}\r\n                >\r\n                  Next\r\n                </div>\r\n              ) : (\r\n                ''\r\n              )}\r\n            </div>\r\n          </div> */}\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  function fetchAdAccountInsights(cursorKey = '', cursorValue = '') {\r\n    setLoading(true)\r\n    fetch(\r\n      // `http://localhost:8000/ad-account/insights/${adAccountId}?${cursorKey}=${cursorValue}`\r\n      `https://fb-ads-api.herokuapp.com/ad-account/insights/${adAccountId}?${cursorKey}=${cursorValue}`\r\n    )\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n        // console.log(res)\r\n        setAdAccount((state) => {\r\n          state.data = formatDataMart(res.data)\r\n        })\r\n        setPaging(res.paging)\r\n        setLoading(false)\r\n      })\r\n  }\r\n\r\n  function formatDataMart(rawData) {\r\n    const dataMart = {}\r\n    rawData.map((data) => {\r\n      const date = data.date_start\r\n      const campaignType = getCampaignType(data)\r\n\r\n      dataMart[date]\r\n        ? dataMart[date][campaignType]\r\n          ? dataMart[date][campaignType].push(data)\r\n          : (dataMart[date][campaignType] = [data])\r\n        : (dataMart[date] = { [campaignType]: [data] })\r\n    })\r\n    // console.log('dataMart:', dataMart)\r\n    return dataMart\r\n  }\r\n\r\n  function getCampaignType(data) {\r\n    return data.campaign_name.includes('預熱')\r\n      ? '預熱'\r\n      : data.campaign_name.includes('前測')\r\n      ? '前測'\r\n      : data.campaign_name.includes('嘖嘖')\r\n      ? '嘖嘖'\r\n      : 'none'\r\n  }\r\n}\r\n\r\nexport default AdAccount\r\n","import React from 'react'\nimport { Router } from '@reach/router'\n\n// utils\n\n// assets\n\n// actions\n\n// components\nimport Home from './Home'\nimport AdAccount from './AdAccount'\n\n// self-defined-components\nconst App = () => {\n  return (\n    <Router basepath=\"/facebook-ad-account-dashboard\" primary={false}>\n      <Home path='/' />\n      <AdAccount path='/ad-account/:adAccountId' />\n    </Router>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './pages/App'\n\nimport 'bootstrap/dist/css/bootstrap.min.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}