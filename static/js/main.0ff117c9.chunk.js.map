{"version":3,"sources":["utils/utils.js","components/Switch.js","pages/Home.js","svgs/SvgLogo.js","svgs/SvgArrowLeft.js","containers/HeaderContainer.js","containers/ProjectContainer.js","pages/AdAccount.js","pages/App.js","index.js"],"names":["format","data","toDollar","toString","replace","toNumber","toProjectTime","split","date","time","substring","toDate","newDate","Date","year","getFullYear","month","getMonth","slice","getDate","toTime","hours","getHours","minutes","getMinutes","Switch","labelFor","isOn","handleToggle","onColor","className","checked","onChange","id","type","style","background","htmlFor","Home","useState","adAccounts","setAdAccounts","user","setUser","isFilter","setIsFilter","filteredAdAccounts","filter","adAccount","adAccountLive","sort","a","b","campaignStatus","value","useEffect","path","URL","document","location","searchParams","get","navigate","window","checkLoginState","FB","getLoginStatus","res","status","state","isLogin","api","name","pictureURL","picture","url","sortedAdAccountsData","adaccounts","age","map","campaigns","forEach","adCampaign","originalStatus","adCampaignName","newStatus","includes","getAdCampaignStatus","handleAdCampaignStatus","console","log","fbAsyncInit","init","appId","cookie","xfbml","version","AppEvents","logPageView","d","s","js","fjs","getElementsByTagName","getElementById","createElement","src","parentNode","insertBefore","onClick","logout","response","alt","width","data-size","data-button-type","data-layout","data-auto-logout-link","data-use-continue-as","data-width","data-onlogin","data-scope","display","length","amount_spent","key","opacity","role","SvgLogo","props","height","viewBox","fill","clipPath","cx","cy","r","gradientUnits","gradientTransform","stopColor","offset","SvgArrowLeft","fillRule","clipRule","HeaderContainer","title","ProjectContainer","project","fundingCurrentNumber","Number","funding_current","fundingTargetNumber","funding_target","goalPercentage","Math","floor","costPerAverageLead","leadSpendTotal","leadTotal","toFixed","totalSpend","preLaunchSpendTotal","fundRaisingSpendTotal","backgroundImage","og_image","href","projectId","target","sponsor_count","started_at","finished_at","AdAccount","adAccountId","loading","setLoading","useImmer","platformId","dateArray","leadSpendDaily","leadDaily","costPerLeadDaily","preLaunchSpendDaily","fundRaisingSpendDaily","adsDirectFundRaisingTotal","adsDirectFundRaisingDaily","adsDirectRoasDaily","fundRaisingTotal","fundRaisingDaily","orderCountTotal","orderCountDaily","totalRoasDaily","setAdAccount","undefined","fundRaisingDateMap","orderCountDateMap","setProject","chartConfigOptions","maintainAspectRatio","hover","intersect","tooltips","mode","scales","yAxes","position","gridLines","drawOnChartArea","scaleLabel","labelString","plugins","datalabels","color","align","leadLineChartData","labels","projectStartIndex","reverse","datasets","label","borderColor","pointBackgroundColor","pointHoverBackgroundColor","yAxisID","fundRaisingLineChartData","fetch","then","json","business_street","business_street2","rawData","dataMart","date_start","campaignType","campaign_name","getCampaignType","push","formatDataMart","Object","keys","values","dateData","adCampaignArray","parseInt","spend","adCampaignSpend","totalLead","actions","adCampaignLeadAction","find","action","action_type","totalRevenue","action_values","adCampaignOmniPurchaseAction","generateChartData","timeline","JSON","parse","fetchFundingData","projectStartDate","findIndex","e","projectStartAt","getTime","projectFinishAt","timelineDataMart","fundingData","fundingOfThePreviousDay","orderOfThePreviousDay","entries","fundingToday","orderToday","index","options","scope","App","basepath","primary","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.0ff117c9.chunk.js","sourcesContent":["export function format(data) {\r\n  return {\r\n    toDollar() {\r\n      return !data\r\n        ? ''\r\n        : `NTD ${data.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')}`\r\n    },\r\n    toNumber() {\r\n      return !data ? '' : data.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\r\n    },\r\n    toProjectTime() {\r\n      const [date, time] = data.split('T')\r\n      return !data ? '' : `${date} ${time.substring(0, 5)}`\r\n    },\r\n    toDate() {\r\n      // input unix time\r\n      const newDate = new Date(data)\r\n      const year = newDate.getFullYear()\r\n      const month = ('0' + (newDate.getMonth() + 1)).slice(-2)\r\n      const date = ('0' + newDate.getDate()).slice(-2)\r\n      return !data ? '' : `${year}-${month}-${date}`\r\n    },\r\n    toTime() {\r\n      // input unix time\r\n      const newDate = new Date(data)\r\n      const hours = ('0' + newDate.getHours()).slice(-2)\r\n      const minutes = ('0' + newDate.getMinutes()).slice(-2)\r\n      return !data ? '' : `${hours}:${minutes}`\r\n    },\r\n  }\r\n}\r\n","import React from 'react'\r\nimport './Switch.css'\r\n\r\nconst Switch = ({ labelFor, isOn, handleToggle, onColor }) => {\r\n  return (\r\n    <>\r\n      <div className='switch-container'>\r\n        <input\r\n          checked={isOn}\r\n          onChange={handleToggle}\r\n          className='react-switch-checkbox'\r\n          id={'react-switch-' + labelFor}\r\n          type='checkbox'\r\n        />\r\n        <label\r\n          style={{ background: isOn && onColor }}\r\n          className='react-switch-label'\r\n          htmlFor={'react-switch-' + labelFor}\r\n        >\r\n          <span className={`react-switch-button`} />\r\n        </label>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Switch\r\n","import React, { useEffect, useState } from 'react'\r\nimport { navigate } from '@reach/router'\r\nimport { format } from '../utils/utils'\r\n\r\nimport './Home.css'\r\n\r\nimport Switch from '../components/Switch'\r\n\r\nfunction Home() {\r\n  const [adAccounts, setAdAccounts] = useState([])\r\n  const [user, setUser] = useState({})\r\n  const [isFilter, setIsFilter] = useState(true)\r\n\r\n  let filteredAdAccounts = isFilter\r\n    ? adAccounts.filter((adAccount) => adAccount.adAccountLive)\r\n    : adAccounts\r\n  filteredAdAccounts = filteredAdAccounts.sort(\r\n    (a, b) => b.campaignStatus.value - a.campaignStatus.value\r\n  )\r\n  useEffect(() => {\r\n    const params = new URL(document.location).searchParams\r\n    const path = params.get('p')\r\n    if (path) {\r\n      navigate(`/facebook-ad-account-dashboard${path}`)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    window.checkLoginState = function () {\r\n      window.FB\r\n        ? window.FB.getLoginStatus((res) => {\r\n            if (res.status === 'connected') {\r\n              // Logged into your webpage and Facebook.\r\n              setUser((state) => ({\r\n                ...state,\r\n                isLogin: true,\r\n              }))\r\n              fetchUserAndAdAccounts()\r\n            } else {\r\n              // Not logged into your webpage or we are unable to tell.\r\n              console.log('Please log into this webpage.')\r\n            }\r\n          })\r\n        : console.log('FB not loaded.')\r\n    }\r\n    window.checkLoginState()\r\n\r\n    window.fbAsyncInit = function () {\r\n      window.FB.init({\r\n        appId: '2772453809519165',\r\n        cookie: true,\r\n        xfbml: true,\r\n        version: 'v6.0',\r\n      })\r\n\r\n      window.FB.AppEvents.logPageView()\r\n      window.checkLoginState()\r\n    }\r\n    ;(function (d, s, id) {\r\n      var js,\r\n        fjs = d.getElementsByTagName(s)[0]\r\n      if (d.getElementById(id)) {\r\n        return\r\n      }\r\n      js = d.createElement(s)\r\n      js.id = id\r\n      js.src =\r\n        'https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v7.0&appId=2772453809519165&autoLogAppEvents=1'\r\n      fjs.parentNode.insertBefore(js, fjs)\r\n    })(document, 'script', 'facebook-jssdk')\r\n  }, [])\r\n\r\n  return (\r\n    <div className='container my-3'>\r\n      {/* Avatar、登出 */}\r\n      {user.pictureURL ? (\r\n        <div className='text-right my-3'>\r\n          <div\r\n            className='btn btn-primary'\r\n            onClick={() =>\r\n              window.FB.logout(function (response) {\r\n                setUser({})\r\n                setAdAccounts([])\r\n              })\r\n            }\r\n          >\r\n            <div className=' d-flex align-items-center'>\r\n              <img\r\n                src={user.pictureURL}\r\n                alt='avatar'\r\n                className='rounded-circle'\r\n                style={{ width: '30px' }}\r\n              />\r\n              <span className='mx-2'>登出</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        ''\r\n      )}\r\n      <h1 className='text-center my-3'>廣告帳號</h1>\r\n      {/* 臉書登入 */}\r\n      <div className='w-100 text-center my-3'>\r\n        <div\r\n          className='fb-login-button'\r\n          data-size='large'\r\n          data-button-type='continue_with'\r\n          data-layout='default'\r\n          data-auto-logout-link='false'\r\n          data-use-continue-as='true'\r\n          data-width=''\r\n          data-onlogin='checkLoginState();'\r\n          data-scope='public_profile,email,ads_read,business_management'\r\n          style={{ display: user.isLogin ? 'none' : 'block' }}\r\n        ></div>\r\n      </div>\r\n\r\n      {/* 廣告帳戶列表 */}\r\n      {filteredAdAccounts.length > 0 ? (\r\n        <>\r\n          <div className='d-flex align-items-center justify-content-center my-2'>\r\n            <Switch\r\n              labelFor={'isFilter'}\r\n              isOn={isFilter}\r\n              handleToggle={() => setIsFilter(!isFilter)}\r\n              onColor='#e43f5a'\r\n            />\r\n            <span>只顯示 Active 廣告帳戶</span>\r\n          </div>\r\n          <main className='d-flex flex-wrap justify-content-center'>\r\n            {filteredAdAccounts.map(\r\n              ({ name, id, adAccountLive, campaignStatus, amount_spent }) => (\r\n                <div\r\n                  key={id}\r\n                  className='card m-1 ad-account-card'\r\n                  style={{ width: '18rem', opacity: !adAccountLive && 0.3 }}\r\n                >\r\n                  <div\r\n                    className='card-body'\r\n                    onClick={() =>\r\n                      navigate(\r\n                        `/facebook-ad-account-dashboard/ad-account/${id}`\r\n                      )\r\n                    }\r\n                  >\r\n                    <span\r\n                      className={\r\n                        'badge badge-' +\r\n                        (campaignStatus.value === 3\r\n                          ? 'success'\r\n                          : campaignStatus.value === 2\r\n                          ? 'primary'\r\n                          : campaignStatus.value === 1\r\n                          ? 'secondary'\r\n                          : '')\r\n                      }\r\n                    >\r\n                      {campaignStatus.name}\r\n                    </span>\r\n\r\n                    <h5 className='card-title'>{name}</h5>\r\n                    <p className='card-text'>\r\n                      總廣告花費：{format(amount_spent).toDollar()}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )\r\n            )}\r\n          </main>\r\n        </>\r\n      ) : (\r\n        <div className='text-center my-5'>\r\n          <div className='spinner-border text-primary' role='status'>\r\n            <span className='sr-only'>Loading...</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  function fetchUserAndAdAccounts() {\r\n    window.FB.api(\r\n      '/me?fields=name,picture{url},adaccounts.limit(1000){age,name,amount_spent,campaigns.limit(1000){status,name}}',\r\n      function (res) {\r\n        setUser((state) => ({\r\n          ...state,\r\n          name: res.name,\r\n          pictureURL: res.picture.data.url,\r\n        }))\r\n\r\n        let sortedAdAccountsData = res.adaccounts.data.sort(\r\n          (a, b) => a.age - b.age\r\n        )\r\n\r\n        // 遍歷廣告活動狀態，在廣告帳戶物件加上 adAccountLive flag\r\n        sortedAdAccountsData = sortedAdAccountsData.map((adAccount) => {\r\n          adAccount.adAccountLive = false\r\n          adAccount.campaignStatus = { name: '', value: 0 }\r\n\r\n          if (adAccount.campaigns) {\r\n            adAccount.campaigns.data.forEach((adCampaign) => {\r\n              if (adCampaign.status === 'ACTIVE') {\r\n                adAccount.adAccountLive = true\r\n              }\r\n              adAccount.campaignStatus = handleAdCampaignStatus(\r\n                adAccount.campaignStatus,\r\n                adCampaign.name\r\n              )\r\n            })\r\n          }\r\n\r\n          return adAccount\r\n        })\r\n        setAdAccounts((state) => [...sortedAdAccountsData])\r\n      }\r\n    )\r\n  }\r\n\r\n  function handleAdCampaignStatus(originalStatus, adCampaignName) {\r\n    // 狀態變成數字來比大小\r\n    // 較大的為現在的狀態\r\n    const newStatus = getAdCampaignStatus(adCampaignName)\r\n    return newStatus.value > originalStatus.value ? newStatus : originalStatus\r\n  }\r\n\r\n  function getAdCampaignStatus(adCampaignName) {\r\n    return adCampaignName.includes('上線')\r\n      ? { name: '上線', value: 3 }\r\n      : adCampaignName.includes('預熱')\r\n      ? { name: '預熱', value: 2 }\r\n      : adCampaignName.includes('前測')\r\n      ? { name: '前測', value: 1 }\r\n      : { name: '', value: 0 }\r\n  }\r\n}\r\n\r\nexport default Home\r\n","import * as React from 'react'\r\n\r\nfunction SvgLogo(props) {\r\n  return (\r\n    <svg width={324} height={403} viewBox='0 0 324 403' fill='none' {...props}>\r\n      <g clipPath='url(#prefix__clip0)'>\r\n        <path\r\n          d='M236.243 182.778c4.452 10.789 3.498 23.482-3.497 33.954-11.129 16.5-33.704 20.943-50.556 9.837l-20.031-13.328-20.031-13.645c-16.534-11.106-39.109-6.664-50.556 9.837-6.995 10.154-7.949 22.847-3.497 33.636 0 0 0 .318.317.318 10.493 25.385 32.432 42.521 57.551 47.915 15.262 3.174 31.478 2.222 47.058-4.125 5.087-2.221 9.857-4.76 14.308-7.616 30.524-20.943 43.56-60.926 28.934-96.783z'\r\n          fill='url(#prefix__paint0_radial)'\r\n        />\r\n        <path\r\n          d='M161.841 302.726c-22.893 0-46.104-8.885-63.592-26.338-16.852-16.818-26.39-39.348-26.39-63.464 0-23.8 9.22-46.33 26.39-63.465 3.816-3.808 9.857-3.808 13.672 0 3.816 3.808 3.816 9.837 0 13.645-13.354 13.327-20.667 30.78-20.667 49.502s7.313 36.492 20.667 49.503c27.345 27.289 71.859 27.289 99.522 0 27.344-27.29 27.344-71.715 0-99.322l-56.279-55.532c-3.816-3.808-3.816-9.837 0-13.645 3.815-3.808 9.857-3.808 13.672 0l56.597 56.484c34.975 34.905 34.975 91.706 0 126.611-17.488 17.453-40.381 26.021-63.592 26.021z'\r\n          fill='#0A2240'\r\n        />\r\n        <path\r\n          d='M162.477 255.445c-5.405 0-9.857-4.443-9.857-9.837v-82.504l-41.334-41.252c-27.98-27.924-27.98-72.984 0-100.909C124.64 7.298 142.763 0 161.841 0s37.201 7.298 50.555 20.943c13.037 13.01 20.668 30.463 20.986 48.868v.317c0 14.28-3.18 26.973-9.857 37.444v.318c-2.862 4.442-8.903 6.029-13.354 3.173-4.452-2.856-6.041-8.885-3.18-13.328v-.317c4.452-7.298 6.995-16.5 6.995-26.972-.318-13.328-5.723-26.02-15.262-35.54-9.856-9.837-22.893-15.232-36.883-15.232-13.99 0-27.026 5.395-36.883 15.232-20.032 19.99-20.032 52.992 0 72.984l44.514 44.425c1.908 1.904 2.862 4.442 2.862 6.981v86.629c0 5.077-4.452 9.52-9.857 9.52zM27.98 156.123c2.544 2.538 3.816 6.664 3.816 12.375v36.81c0 4.125 2.226 6.664 6.041 6.664h3.498c4.133 0 7.63 2.221 7.63 7.615 0 5.395-3.497 7.616-7.63 7.616H32.75c-10.493 0-18.442-6.346-18.442-19.039v-38.079c0-4.76-1.272-7.616-2.861-9.202-1.59-1.587-3.498-1.904-5.406-2.222-4.451-.634-6.359-3.173-6.359-7.615 0-4.443 1.908-6.664 6.36-7.616 1.907-.317 4.133-.952 5.723-2.539 1.59-1.586 2.543-4.125 2.543-8.567v-38.08c0-12.692 7.95-19.038 18.442-19.038h8.585c4.133 0 7.63 2.22 7.63 7.615s-3.497 7.616-7.63 7.616h-3.18c-3.816 0-6.041 2.539-6.041 6.664v36.809c0 5.712-1.59 9.52-3.816 12.059-2.543 2.855-6.04 4.442-8.585 4.442v.317c2.544 1.27 6.042 2.539 8.267 5.395zM304.287 151.363c-2.544-.317-6.042-1.587-8.585-4.443-2.226-2.538-3.816-6.663-3.816-12.058V97.735c0-4.125-2.226-6.663-6.041-6.663h-3.498c-4.133 0-7.631-2.222-7.631-7.616 0-5.395 3.498-7.616 7.631-7.616h8.585c10.493 0 18.442 6.347 18.442 19.04v38.078c0 4.443.954 7.299 2.544 8.568 1.589 1.587 3.497 2.221 5.723 2.539 4.451.952 6.359 3.173 6.359 7.615 0 4.443-1.908 6.981-6.359 7.616-1.908.317-3.816.635-5.405 2.221-1.59 1.587-2.862 4.126-2.862 9.203v38.078c0 12.693-7.949 19.04-18.442 19.04h-8.585c-4.133 0-7.631-2.221-7.631-7.616 0-5.394 3.498-7.616 7.631-7.616h3.498c3.815 0 6.041-2.538 6.041-6.663v-37.445c0-5.711 1.59-9.519 3.816-12.058 2.543-3.173 6.041-4.442 8.585-5.077zM54.371 388.403c0 8.885-8.267 14.597-20.35 14.597-9.538 0-16.215-3.173-18.759-9.202-1.272-3.174.954-6.347 4.451-6.347h.636c1.908 0 3.816.952 4.452 2.856 1.272 2.856 4.451 4.443 9.857 4.443 6.04 0 9.538-2.222 9.538-6.03 0-11.74-28.934-2.538-28.934-22.847 0-8.567 7.949-14.597 19.395-14.597 8.903 0 15.263 3.174 17.806 8.885 1.272 3.174-.954 6.347-4.451 6.347h-.636c-1.908 0-3.816-.952-4.452-2.856-1.271-2.856-4.133-4.125-8.584-4.125-6.042 0-8.903 2.221-8.903 5.712 0 11.423 28.934 2.221 28.934 23.164zM84.26 384.278v13.328c0 2.538-2.227 4.759-4.77 4.759h-.954c-2.544 0-4.77-2.221-4.77-4.759v-13.645c0-.952-.318-1.587-.636-2.222l-13.036-23.164c-1.907-3.173.636-6.981 4.134-6.981 1.59 0 3.18.952 4.133 2.538l10.81 19.674 10.493-19.674c.954-1.586 2.544-2.538 4.134-2.538 3.497 0 5.723 3.808 4.133 6.981l-13.354 23.482c-.318.634-.318 1.586-.318 2.221zM123.05 379.835c0-2.221 1.908-4.125 4.134-4.125h1.589c5.088 0 7.949-3.173 7.949-7.933 0-4.442-2.861-7.616-7.949-7.616h-6.041c-2.544 0-4.769 2.222-4.769 4.76v33.002c0 2.538-2.226 4.76-4.77 4.76h-.954c-2.543 0-4.769-2.222-4.769-4.76v-38.714c0-4.125 3.498-7.615 7.631-7.615h13.354c11.447 0 18.442 5.712 18.442 16.183 0 10.472-6.995 16.184-18.442 16.184h-1.589c-1.908 0-3.816-1.904-3.816-4.126zM197.77 356.354v41.569c0 2.538-2.225 4.76-4.769 4.76h-.954c-2.544 0-4.769-2.222-4.769-4.76v-16.818h-22.575v16.818c0 2.538-2.226 4.76-4.77 4.76h-.954c-2.543 0-4.769-2.222-4.769-4.76v-41.569c0-2.539 2.226-4.76 4.769-4.76h.954c2.544 0 4.77 2.221 4.77 4.76v15.866h22.893v-15.866c0-2.539 2.225-4.76 4.769-4.76h.954c2.226 0 4.451 2.221 4.451 4.76zM206.673 377.297c0-15.866 10.811-26.021 25.437-26.021 14.626 0 25.437 9.837 25.437 25.704 0 16.183-10.811 26.02-25.437 26.02-14.626 0-25.437-9.837-25.437-25.703zm40.381-.317c0-10.789-6.677-17.136-14.944-17.136-8.267 0-14.944 6.347-14.944 17.136 0 10.789 6.677 17.135 14.944 17.135 8.267 0 14.944-6.346 14.944-17.135zM309.056 356.354v41.569c0 2.538-2.226 4.76-4.769 4.76h-2.226c-1.59 0-3.18-.952-3.816-2.222l-21.939-33.318v30.78c0 2.538-2.226 4.76-4.769 4.76h-.636c-2.544 0-4.769-2.222-4.769-4.76v-41.569c0-2.539 2.225-4.76 4.769-4.76h2.226c1.589 0 3.179.952 3.815 2.221l21.939 33.636v-30.78c0-2.539 2.226-4.76 4.77-4.76h.636c2.861-.317 4.769 1.904 4.769 4.443z'\r\n          fill='#0A2240'\r\n        />\r\n      </g>\r\n      <defs>\r\n        <radialGradient\r\n          id='prefix__paint0_radial'\r\n          cx={0}\r\n          cy={0}\r\n          r={1}\r\n          gradientUnits='userSpaceOnUse'\r\n          gradientTransform='matrix(128.005 0 0 127.749 161.502 161.916)'\r\n        >\r\n          <stop stopColor='#FFB819' />\r\n          <stop offset={1} stopColor='#FF48CC' />\r\n        </radialGradient>\r\n        <clipPath id='prefix__clip0'>\r\n          <path fill='#fff' d='M0 0h324v403H0z' />\r\n        </clipPath>\r\n      </defs>\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport default SvgLogo\r\n","import * as React from 'react'\r\n\r\nfunction SvgArrowLeft(props) {\r\n  return (\r\n    <svg width={24} height={24} viewBox='0 0 24 24' fill='none' {...props}>\r\n      <path\r\n        fillRule='evenodd'\r\n        clipRule='evenodd'\r\n        d='M12.707 5.707a1 1 0 00-1.414-1.414l-7 7a1 1 0 000 1.414l7 7a1 1 0 001.414-1.414L7.414 13H19a1 1 0 100-2H7.414l5.293-5.293z'\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n\r\nexport default SvgArrowLeft\r\n","import React from 'react'\r\nimport { navigate } from '@reach/router'\r\nimport { SvgLogo, SvgArrowLeft } from '../svgs'\r\n\r\nimport './HeaderContainer.scss'\r\n\r\nconst HeaderContainer = ({ title }) => {\r\n  return (\r\n    <header className='header'>\r\n      <div className='header__line-left'>\r\n        <div\r\n          className='header__back-to-home'\r\n          onClick={() => navigate('/facebook-ad-account-dashboard/')}\r\n        >\r\n          <SvgArrowLeft className='header__arrow-left' />\r\n          <span className='header__back-to-home-text'>Home</span>\r\n        </div>\r\n        <div className='header__title'>{title}</div>\r\n      </div>\r\n      <SvgLogo className='header__logo' />\r\n      <div className='header__line-right'></div>\r\n    </header>\r\n  )\r\n}\r\n\r\nexport default HeaderContainer\r\n","import React from 'react'\r\nimport { format } from '../utils/utils'\r\nimport './ProjectContainer.scss'\r\n\r\nconst ProjectContainer = ({ project, adAccount }) => {\r\n  if (!project.id) {\r\n    return null\r\n  }\r\n\r\n  const fundingCurrentNumber = Number(\r\n    project.funding_current.replace(/NTD /g, '').replace(/,/g, '')\r\n  )\r\n  const fundingTargetNumber = Number(\r\n    project.funding_target.replace(/NTD /g, '').replace(/,/g, '')\r\n  )\r\n  const goalPercentage = Math.floor(\r\n    (fundingCurrentNumber / fundingTargetNumber) * 100\r\n  )\r\n  const costPerAverageLead = Number(\r\n    adAccount.leadSpendTotal / adAccount.leadTotal\r\n  ).toFixed(1)\r\n  const totalSpend = format(\r\n    adAccount.leadSpendTotal +\r\n      adAccount.preLaunchSpendTotal +\r\n      adAccount.fundRaisingSpendTotal\r\n  ).toDollar()\r\n\r\n  return (\r\n    <div className='row'>\r\n      <div className='col-12 col-sm-6 col-lg-4 project__image'>\r\n        <div style={{ backgroundImage: `url(${project.og_image})` }}></div>\r\n      </div>\r\n      <div className='col-12 col-sm-6 col-lg-4 project__content'>\r\n        <div className='project__content-title'>\r\n          {/* TODO: 串接其他平台 */}\r\n          <a\r\n            href={'https://www.zeczec.com/projects/' + adAccount.projectId}\r\n            target='blank'\r\n          >\r\n            {project.name}\r\n          </a>\r\n        </div>\r\n        <h2 className='project__content-funding-current'>\r\n          {project.funding_current}\r\n        </h2>\r\n        <div className='project__content-info'>\r\n          <div className='project__content-info-list'>\r\n            <div className='list__key'>目標</div>\r\n            <div className='list__value'>{project.funding_target}</div>\r\n          </div>\r\n          <div className='project__content-info-list'>\r\n            <div className='list__key'>達成比例</div>\r\n            <div className='list__value'>\r\n              {format(goalPercentage).toNumber()}%\r\n            </div>\r\n          </div>\r\n          <div className='project__content-info-list'>\r\n            <div className='list__key'>贊助人數</div>\r\n            <div className='list__value'>{project.sponsor_count}</div>\r\n          </div>\r\n          <div className='project__content-info-list'>\r\n            <div className='list__key'>時程</div>\r\n            <div className='list__value'>\r\n              {project.started_at} ~ {project.finished_at}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className='col-12 col-lg-4 project__ad-stats'>\r\n        <div className='ad-stats__list'>\r\n          <div className='ad-stats__key'>平均 CPL</div>\r\n          <div className='ad-stats__value'>{costPerAverageLead}</div>\r\n        </div>\r\n        <div className='ad-stats__list'>\r\n          <div className='ad-stats__key'>花費</div>\r\n          <div className='ad-stats__value'>{totalSpend}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ProjectContainer\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useImmer } from 'use-immer'\r\nimport { Line } from 'react-chartjs-2'\r\nimport ChartDataLabels from 'chartjs-plugin-datalabels'\r\nimport { format } from '../utils/utils'\r\n\r\nimport { HeaderContainer, ProjectContainer } from '../containers'\r\n\r\nimport './AdAccount.scss'\r\n\r\nfunction AdAccount({ adAccountId }) {\r\n  const [loading, setLoading] = useState(true)\r\n  const [adAccount, setAdAccount] = useImmer({\r\n    name: '',\r\n    platformId: '',\r\n    projectId: '',\r\n    data: [],\r\n    dateArray: [],\r\n\r\n    leadSpendTotal: 0,\r\n    leadSpendDaily: [],\r\n    leadTotal: 0,\r\n    leadDaily: [],\r\n    costPerLeadDaily: [],\r\n\r\n    preLaunchSpendTotal: 0,\r\n    preLaunchSpendDaily: [],\r\n\r\n    fundRaisingSpendTotal: 0,\r\n    fundRaisingSpendDaily: [],\r\n    adsDirectFundRaisingTotal: 0,\r\n    adsDirectFundRaisingDaily: [],\r\n    adsDirectRoasDaily: [],\r\n\r\n    fundRaisingTotal: 0,\r\n    fundRaisingDaily: [],\r\n    orderCountTotal: 0,\r\n    orderCountDaily: [],\r\n    totalRoasDaily: [],\r\n  })\r\n  const [project, setProject] = useImmer({\r\n    started_at: undefined,\r\n    fundRaisingDateMap: undefined,\r\n    orderCountDateMap: undefined,\r\n  })\r\n\r\n  const chartConfigOptions = {\r\n    maintainAspectRatio: false,\r\n    hover: {\r\n      intersect: false,\r\n    },\r\n    tooltips: {\r\n      mode: 'index',\r\n      intersect: false,\r\n    },\r\n    scales: {\r\n      yAxes: [\r\n        {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'left',\r\n          id: 'y-axis-1',\r\n          gridLines: {\r\n            drawOnChartArea: false,\r\n          },\r\n          scaleLabel: {\r\n            display: true,\r\n            labelString: '名單取得成本',\r\n          },\r\n        },\r\n        {\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'right',\r\n          id: 'y-axis-2',\r\n          scaleLabel: {\r\n            display: true,\r\n            labelString: 'ROAS',\r\n          },\r\n        },\r\n      ],\r\n    },\r\n    plugins: {\r\n      datalabels: {\r\n        color: 'black',\r\n        align: 'top',\r\n        offset: 8,\r\n      },\r\n    },\r\n  }\r\n\r\n  const leadLineChartData = {\r\n    labels: project.projectStartIndex\r\n      ? [...adAccount.dateArray]\r\n          .reverse()\r\n          .slice(0, project.projectStartIndex + 1)\r\n      : [...adAccount.dateArray].reverse(),\r\n    datasets: [\r\n      {\r\n        label: 'CPL',\r\n        fill: false,\r\n        borderColor: '#1f4068',\r\n        pointBackgroundColor: '#1f4068',\r\n        pointHoverBackgroundColor: '#1f4068',\r\n        data: project.projectStartIndex\r\n          ? [...adAccount.costPerLeadDaily]\r\n              .reverse()\r\n              .slice(0, project.projectStartIndex + 1)\r\n          : [...adAccount.costPerLeadDaily].reverse(),\r\n        yAxisID: 'y-axis-1',\r\n      },\r\n    ],\r\n  }\r\n\r\n  const fundRaisingLineChartData = {\r\n    labels: project.projectStartIndex\r\n      ? [...adAccount.dateArray].reverse().slice(project.projectStartIndex)\r\n      : [],\r\n    datasets: [\r\n      {\r\n        label: '總體 ROAS',\r\n        fill: false,\r\n        borderColor: '#e43f5a',\r\n        pointBackgroundColor: '#e43f5a',\r\n        pointHoverBackgroundColor: '#e43f5a',\r\n        data: project.projectStartIndex\r\n          ? [...adAccount.totalRoasDaily]\r\n              .reverse()\r\n              .slice(project.projectStartIndex)\r\n          : [],\r\n        yAxisID: 'y-axis-2',\r\n      },\r\n    ],\r\n  }\r\n\r\n  // 取得廣告帳號資料、廣告數據資料\r\n  useEffect(() => {\r\n    fetchAdAccountInfo()\r\n    fetchAdAccountInsights()\r\n\r\n    function fetchAdAccountInfo() {\r\n      fetch(\r\n        // `http://localhost:8000/ad-account/info/${adAccountId}`\r\n        `https://fb-ads-api.herokuapp.com/ad-account/info/${adAccountId}`\r\n      )\r\n        .then((res) => res.json())\r\n        .then((res) => {\r\n          setAdAccount((state) => {\r\n            state.name = res.name\r\n            state.platformId = res.business_street\r\n            state.projectId = res.business_street2\r\n          })\r\n        })\r\n    }\r\n\r\n    function fetchAdAccountInsights() {\r\n      setLoading(true)\r\n      fetch(\r\n        // `http://localhost:8000/ad-account/insights/${adAccountId}`\r\n        `https://fb-ads-api.herokuapp.com/ad-account/insights/${adAccountId}`\r\n      )\r\n        .then((res) => res.json())\r\n        .then((res) => {\r\n          // console.log(res)\r\n          setAdAccount((state) => {\r\n            state.data = formatDataMart(res.data)\r\n          })\r\n          setLoading(false)\r\n        })\r\n    }\r\n\r\n    function formatDataMart(rawData) {\r\n      const dataMart = {}\r\n      rawData.forEach((data) => {\r\n        const date = data.date_start\r\n        const campaignType = getCampaignType(data)\r\n\r\n        dataMart[date]\r\n          ? dataMart[date][campaignType]\r\n            ? dataMart[date][campaignType].push(data)\r\n            : (dataMart[date][campaignType] = [data])\r\n          : (dataMart[date] = { [campaignType]: [data] })\r\n      })\r\n      // console.log('dataMart:', dataMart)\r\n      return dataMart\r\n    }\r\n\r\n    function getCampaignType(data) {\r\n      return data.campaign_name.includes('預熱')\r\n        ? '預熱'\r\n        : data.campaign_name.includes('前測')\r\n        ? '前測'\r\n        : data.campaign_name.includes('上線')\r\n        ? '上線'\r\n        : 'none'\r\n    }\r\n  }, [adAccountId, setAdAccount])\r\n\r\n  // 處理廣告數據資料\r\n  useEffect(() => {\r\n    generateChartData()\r\n\r\n    function generateChartData() {\r\n      let dateArray = Object.keys(adAccount.data)\r\n\r\n      let leadSpendTotal = 0\r\n      let leadSpendDaily = []\r\n      let leadTotal = 0\r\n      let leadDaily = []\r\n      let costPerLeadDaily = []\r\n\r\n      let preLaunchSpendTotal = 0\r\n      let preLaunchSpendDaily = []\r\n\r\n      let fundRaisingSpendTotal = 0\r\n      let fundRaisingSpendDaily = []\r\n      let adsDirectFundRaisingTotal = 0\r\n      let adsDirectFundRaisingDaily = []\r\n      let adsDirectRoasDaily = []\r\n\r\n      Object.values(adAccount.data).forEach((dateData) => {\r\n        if (dateData['預熱']) {\r\n          const adCampaignArray = dateData['預熱']\r\n          let totalSpend = 0\r\n\r\n          adCampaignArray.forEach((adCampaign) => {\r\n            if (parseInt(adCampaign.spend) === 0) {\r\n              return\r\n            }\r\n\r\n            const adCampaignSpend = parseInt(adCampaign.spend)\r\n\r\n            totalSpend += adCampaignSpend\r\n          })\r\n          if (totalSpend !== 0) {\r\n            preLaunchSpendTotal += totalSpend\r\n            preLaunchSpendDaily.push(totalSpend)\r\n          } else {\r\n            preLaunchSpendDaily.push(null)\r\n          }\r\n        } else {\r\n          preLaunchSpendDaily.push(null)\r\n        }\r\n\r\n        if (dateData['前測']) {\r\n          const adCampaignArray = dateData['前測']\r\n          let totalSpend = 0\r\n          let totalLead = 0\r\n\r\n          adCampaignArray.forEach((adCampaign) => {\r\n            if (parseInt(adCampaign.spend) === 0 || !adCampaign.actions) {\r\n              return\r\n            }\r\n\r\n            const adCampaignSpend = parseInt(adCampaign.spend)\r\n            const adCampaignLeadAction = adCampaign.actions.find(\r\n              (action) =>\r\n                action.action_type === 'offsite_conversion.fb_pixel_custom' ||\r\n                action.action_type === 'lead'\r\n            )\r\n\r\n            totalSpend += adCampaignSpend\r\n            totalLead += adCampaignLeadAction\r\n              ? parseInt(adCampaignLeadAction.value)\r\n              : 0\r\n          })\r\n          if (totalSpend !== 0 && totalLead !== 0) {\r\n            leadSpendTotal += totalSpend\r\n            leadSpendDaily.push(totalSpend)\r\n\r\n            leadTotal += totalLead\r\n            leadDaily.push(totalLead)\r\n            costPerLeadDaily.push((totalSpend / totalLead).toFixed(1))\r\n          } else {\r\n            leadSpendDaily.push(null)\r\n            leadDaily.push(null)\r\n            costPerLeadDaily.push(null)\r\n          }\r\n        } else {\r\n          leadSpendDaily.push(null)\r\n          leadDaily.push(null)\r\n          costPerLeadDaily.push(null)\r\n        }\r\n\r\n        if (dateData['上線']) {\r\n          const adCampaignArray = dateData['上線']\r\n          let totalSpend = 0\r\n          let totalRevenue = 0\r\n\r\n          adCampaignArray.forEach((adCampaign) => {\r\n            if (parseInt(adCampaign.spend) === 0 || !adCampaign.action_values) {\r\n              return\r\n            }\r\n\r\n            const adCampaignSpend = parseInt(adCampaign.spend)\r\n            const adCampaignOmniPurchaseAction = adCampaign.action_values.find(\r\n              (action) => action.action_type === 'omni_purchase'\r\n            )\r\n            totalSpend += adCampaignSpend\r\n            totalRevenue += adCampaignOmniPurchaseAction\r\n              ? parseInt(adCampaignOmniPurchaseAction.value)\r\n              : 0\r\n          })\r\n\r\n          if (totalSpend !== 0 && totalRevenue !== 0) {\r\n            fundRaisingSpendTotal += totalSpend\r\n            fundRaisingSpendDaily.push(totalSpend)\r\n            adsDirectFundRaisingTotal += totalRevenue\r\n            adsDirectFundRaisingDaily.push(totalRevenue)\r\n            adsDirectRoasDaily.push((totalRevenue / totalSpend).toFixed(1))\r\n          } else {\r\n            fundRaisingSpendDaily.push(null)\r\n            adsDirectFundRaisingDaily.push(null)\r\n            adsDirectRoasDaily.push(null)\r\n          }\r\n        } else {\r\n          fundRaisingSpendDaily.push(null)\r\n          adsDirectFundRaisingDaily.push(null)\r\n          adsDirectRoasDaily.push(null)\r\n        }\r\n      })\r\n\r\n      // console.log(adAccount.data, leadSpendDaily, costPerLeadDaily)\r\n\r\n      setAdAccount((state) => {\r\n        state.dateArray = dateArray\r\n\r\n        state.leadSpendTotal = leadSpendTotal\r\n        state.leadSpendDaily = leadSpendDaily\r\n        state.leadTotal = leadTotal\r\n        state.leadDaily = leadDaily\r\n        state.costPerLeadDaily = costPerLeadDaily\r\n\r\n        state.preLaunchSpendTotal = preLaunchSpendTotal\r\n        state.preLaunchSpendDaily = preLaunchSpendDaily\r\n\r\n        state.fundRaisingSpendTotal = fundRaisingSpendTotal\r\n        state.fundRaisingSpendDaily = fundRaisingSpendDaily\r\n        state.adsDirectFundRaisingTotal = adsDirectFundRaisingTotal\r\n        state.adsDirectFundRaisingDaily = adsDirectFundRaisingDaily\r\n        state.adsDirectRoasDaily = adsDirectRoasDaily\r\n      })\r\n    }\r\n  }, [adAccount.data, setAdAccount])\r\n\r\n  // 取得嘖嘖集資資料\r\n  useEffect(() => {\r\n    const platformId = adAccount.platformId\r\n    const projectId = adAccount.projectId\r\n    if (platformId && projectId) {\r\n      fetchFundingData(platformId, projectId)\r\n    }\r\n\r\n    function fetchFundingData(platformId, projectId) {\r\n      fetch(\r\n        `https://drip.zectrack.today/api/platform/${platformId}/projects/${projectId}`\r\n      )\r\n        .then((res) => res.json())\r\n        .then((res) => {\r\n          setProject((state) => ({\r\n            ...state,\r\n            ...res,\r\n            timeline: JSON.parse(res.timeline).sort((a, b) => a[0] - b[0]),\r\n            sponsor_count: format(res.sponsor_count).toNumber(),\r\n            funding_target: format(res.funding_target).toDollar(),\r\n            funding_current: format(res.funding_current).toDollar(),\r\n            started_at: format(res.started_at).toProjectTime(),\r\n            finished_at: format(res.finished_at).toProjectTime(),\r\n          }))\r\n        })\r\n    }\r\n  }, [adAccount.platformId, adAccount.projectId, setProject])\r\n\r\n  // 處理嘖嘖集資資料\r\n  useEffect(() => {\r\n    if (!project.timeline) return\r\n\r\n    const projectStartDate = project.started_at.slice(0, 10)\r\n    const projectStartIndex = [...adAccount.dateArray]\r\n      .reverse()\r\n      .findIndex((e) => e === projectStartDate)\r\n\r\n    // Add datetime.slice(0,-1) to cut the denoted by the suffix \"Z\"\r\n    let projectStartAt =\r\n      new Date(project.started_at.slice(0, -1)).getTime() / 1000\r\n    let projectFinishAt =\r\n      new Date(project.finished_at.slice(0, -1)).getTime() / 1000\r\n    // Minus one hour to get the zero data.\r\n    projectStartAt = projectStartAt - 60 * 60\r\n\r\n    const timelineDataMart = {}\r\n    project.timeline.forEach((data) => {\r\n      if (data[0] < projectStartAt || data[0] > projectFinishAt) return\r\n\r\n      const date = format(data[0] * 1000).toDate()\r\n      const time = format(data[0] * 1000).toTime()\r\n      const fundingData = [time, data[1], data[2]]\r\n\r\n      timelineDataMart[date]\r\n        ? timelineDataMart[date].push(fundingData)\r\n        : (timelineDataMart[date] = [fundingData])\r\n    })\r\n\r\n    const fundRaisingDateMap = {}\r\n    const orderCountDateMap = {}\r\n    let fundingOfThePreviousDay = 0\r\n    let orderOfThePreviousDay = 0\r\n    for (let [date, fundingData] of Object.entries(timelineDataMart)) {\r\n      const fundingToday = fundingData[fundingData.length - 1][2]\r\n      const orderToday = fundingData[fundingData.length - 1][1]\r\n      fundRaisingDateMap[date] = fundingToday - fundingOfThePreviousDay\r\n      orderCountDateMap[date] = orderToday - orderOfThePreviousDay\r\n      fundingOfThePreviousDay = fundingToday\r\n      orderOfThePreviousDay = orderToday\r\n    }\r\n\r\n    setProject((state) => {\r\n      state.fundRaisingDateMap = fundRaisingDateMap\r\n      state.orderCountDateMap = orderCountDateMap\r\n      state.projectStartIndex = projectStartIndex\r\n    })\r\n  }, [\r\n    project.timeline,\r\n    project.started_at,\r\n    project.finished_at,\r\n    setProject,\r\n    adAccount.dateArray,\r\n  ])\r\n\r\n  // 嘖嘖集資資料 => 廣數數據資料\r\n  useEffect(() => {\r\n    if (\r\n      project.fundRaisingDateMap &&\r\n      adAccount.fundRaisingSpendDaily.length > 0\r\n    ) {\r\n      let fundRaisingTotal = 0\r\n      const fundRaisingDaily = []\r\n      let orderCountTotal = 0\r\n      const orderCountDaily = []\r\n\r\n      const totalRoasDaily = []\r\n      adAccount.dateArray.forEach((date, index) => {\r\n        if (\r\n          project.fundRaisingDateMap[date] &&\r\n          project.orderCountDateMap[date] &&\r\n          adAccount.fundRaisingSpendDaily[index]\r\n        ) {\r\n          fundRaisingTotal += project.fundRaisingDateMap[date]\r\n          fundRaisingDaily.push(project.fundRaisingDateMap[date])\r\n          orderCountTotal += project.orderCountDateMap[date]\r\n          orderCountDaily.push(project.orderCountDateMap[date])\r\n          totalRoasDaily.push(\r\n            (\r\n              project.fundRaisingDateMap[date] /\r\n              adAccount.fundRaisingSpendDaily[index]\r\n            ).toFixed(1)\r\n          )\r\n        } else {\r\n          orderCountDaily.push(null)\r\n          fundRaisingDaily.push(null)\r\n          totalRoasDaily.push(null)\r\n        }\r\n      })\r\n      setAdAccount((state) => {\r\n        state.fundRaisingTotal = fundRaisingTotal\r\n        state.fundRaisingDaily = fundRaisingDaily\r\n        state.orderCountTotal = orderCountTotal\r\n        state.orderCountDaily = orderCountDaily\r\n        state.totalRoasDaily = totalRoasDaily\r\n      })\r\n    }\r\n  }, [\r\n    project.fundRaisingDateMap,\r\n    project.orderCountDateMap,\r\n    adAccount.fundRaisingSpendDaily,\r\n    adAccount.dateArray,\r\n    setAdAccount,\r\n  ])\r\n\r\n  return (\r\n    <div className='container my-3'>\r\n      <HeaderContainer title={adAccount.name} />\r\n      {loading ? (\r\n        <div className='text-center my-5'>\r\n          <div className='spinner-border text-primary' role='status'>\r\n            <span className='sr-only'>Loading...</span>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* 集資資料 */}\r\n          <ProjectContainer project={project} adAccount={adAccount} />\r\n\r\n          {/* 圖表 */}\r\n          <div className='my-5' style={{ height: '300px' }}>\r\n            <Line data={leadLineChartData} options={chartConfigOptions} />\r\n          </div>\r\n          {project.id && (\r\n            <div className='my-5' style={{ height: '300px' }}>\r\n              <Line\r\n                data={fundRaisingLineChartData}\r\n                options={chartConfigOptions}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* 走速表 */}\r\n          <div className='table-responsive'>\r\n            <div className='tableFixHead'>\r\n              <table className='table'>\r\n                <thead>\r\n                  <tr>\r\n                    <th scope='col'>Date</th>\r\n                    <th scope='col'>前測花費</th>\r\n                    <th scope='col'>名單數</th>\r\n                    <th scope='col'>CPL</th>\r\n                    <th scope='col'>預熱花費</th>\r\n                    <th scope='col'>上線花費</th>\r\n                    <th scope='col'>廣告直接轉換金額</th>\r\n                    <th scope='col'>廣告直接 ROAS</th>\r\n                    <th scope='col'>每日訂單數</th>\r\n                    <th scope='col'>每日集資金額</th>\r\n                    <th scope='col'>總體 ROAS</th>\r\n                  </tr>\r\n                  <tr>\r\n                    <td>總計</td>\r\n                    <td>{format(adAccount.leadSpendTotal).toDollar()}</td>\r\n                    <td>{format(adAccount.leadTotal).toNumber()}</td>\r\n                    <td>\r\n                      {(adAccount.leadSpendTotal / adAccount.leadTotal).toFixed(\r\n                        1\r\n                      )}\r\n                    </td>\r\n                    <td>{format(adAccount.preLaunchSpendTotal).toDollar()}</td>\r\n                    <td>\r\n                      {format(adAccount.fundRaisingSpendTotal).toDollar()}\r\n                    </td>\r\n                    <td>\r\n                      {format(adAccount.adsDirectFundRaisingTotal).toDollar()}\r\n                    </td>\r\n                    <td>\r\n                      {(\r\n                        adAccount.adsDirectFundRaisingTotal /\r\n                        adAccount.fundRaisingSpendTotal\r\n                      ).toFixed(1)}\r\n                    </td>\r\n                    <td>{format(adAccount.orderCountTotal).toNumber()}</td>\r\n                    <td>{format(adAccount.fundRaisingTotal).toDollar()}</td>\r\n                    <td>\r\n                      {(\r\n                        adAccount.fundRaisingTotal /\r\n                        adAccount.fundRaisingSpendTotal\r\n                      ).toFixed(1)}\r\n                    </td>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {adAccount.dateArray.map((date, index) => {\r\n                    return (\r\n                      <tr key={`daily-adAccount-data-${index}`}>\r\n                        <th>{date}</th>\r\n                        <td>\r\n                          {format(adAccount.leadSpendDaily[index]).toDollar()}\r\n                        </td>\r\n                        <td>{format(adAccount.leadDaily[index]).toNumber()}</td>\r\n                        <td>\r\n                          {format(adAccount.costPerLeadDaily[index]).toDollar()}\r\n                        </td>\r\n                        <td>\r\n                          {format(\r\n                            adAccount.preLaunchSpendDaily[index]\r\n                          ).toDollar()}\r\n                        </td>\r\n                        <td>\r\n                          {format(\r\n                            adAccount.fundRaisingSpendDaily[index]\r\n                          ).toDollar()}\r\n                        </td>\r\n                        <td>\r\n                          {format(\r\n                            adAccount.adsDirectFundRaisingDaily[index]\r\n                          ).toDollar()}\r\n                        </td>\r\n                        <td>{adAccount.adsDirectRoasDaily[index]}</td>\r\n                        <td>{adAccount.orderCountDaily[index]}</td>\r\n                        <td>\r\n                          {format(adAccount.fundRaisingDaily[index]).toDollar()}\r\n                        </td>\r\n                        <td>{adAccount.totalRoasDaily[index]}</td>\r\n                      </tr>\r\n                    )\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default AdAccount\r\n","import React from 'react'\nimport { Router } from '@reach/router'\n\n// utils\n\n// assets\n\n// actions\n\n// components\nimport Home from './Home'\nimport AdAccount from './AdAccount'\n\n// self-defined-components\nconst App = () => {\n  return (\n    <Router basepath=\"/facebook-ad-account-dashboard\" primary={false}>\n      <Home path='/' />\n      <AdAccount path='/ad-account/:adAccountId' />\n    </Router>\n  )\n}\n\nexport default App\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport App from './pages/App'\r\n\r\nimport 'bootstrap/dist/css/bootstrap.min.css'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n)\r\n"],"sourceRoot":""}